# Coverage Exceptions Registry
#
# This file documents all coverage ignore directives in the codebase.
# Each exception must have a clear rationale explaining why the code
# cannot or should not be tested.
#
# Format:
#   file_path:
#     - line: <line_number>
#       pattern: "/* c8 ignore next */"
#       reason: "Explanation of why this is ignored"
#
# A test validates that all ignore directives in the codebase are
# documented here. If you add a new ignore, you must add it here.

src/audit.ts:
  - line: 196
    pattern: "/* c8 ignore next 6 */"
    reason: "IndexedDB transaction onerror handler - cannot be reliably triggered in tests without mocking IDB internals"

  - line: 262
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 288
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 314
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 323
    pattern: "} /* c8 ignore next 2 */ catch {"
    reason: "Defensive error handling for cursor iteration - would require corrupting IndexedDB state"

src/client.ts:
  - line: 78
    pattern: "/* c8 ignore next 3 - defensive: worker is always initialized in constructor */"
    reason: "Defensive null check for worker - constructor always initializes worker, this path is unreachable"

src/storage.ts:
  - line: 89
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB transaction onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 132
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB transaction onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 166
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB request onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 187
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB request onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 208
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB request onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 229
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB request onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 331
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB transaction onerror handler - cannot be reliably triggered without mocking IDB internals"

  - line: 369
    pattern: "/* c8 ignore next 3 */"
    reason: "IndexedDB request onerror handler - cannot be reliably triggered without mocking IDB internals"

src/worker.ts:
  - line: 156
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 191
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 249
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 287
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 305
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 322
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 375
    pattern: "/* c8 ignore next 8 - Environment-dependent branches: DER in production, P-1363 in tests */"
    reason: "Signature format handling - production browsers return DER, test environment returns P-1363. All branches tested: DER conversion in crypto-utils.test.ts, P-1363 passthrough tested in worker tests, unknown format is defensive"

  - line: 389
    pattern: "/* c8 ignore next */"
    reason: "Optional origin parameter spread - cannot test both branches simultaneously"

  - line: 521
    pattern: "/* c8 ignore next - defensive: all Web APIs throw Error objects */"
    reason: "Defensive instanceof check - all Web Crypto APIs throw Error objects, else branch unreachable"

  - line: 656
    pattern: "/* c8 ignore next - defensive: all Web APIs throw Error objects */"
    reason: "Defensive instanceof check - all Web Crypto APIs throw Error objects, else branch unreachable"

  - line: 675
    pattern: "/* c8 ignore next 7 - only runs in real Worker context, not in tests */"
    reason: "Worker message listener setup - only executes in real Worker context, tests call handleMessage directly"
