# üîê KMS Verification Report

## Verification Summary

**Status:** ‚úÖ VERIFIED

**Timestamp:** Fri, 14 Nov 2025 03:29:40 GMT

**Worker Hash:** dcdb17b1

**Workflow Run:** [View Details](https://github.com/Lukium/ats-kms-enclave/actions/runs/19353345666)

---

## About This Report

This report is automatically generated by the [KMS Verifier](https://github.com/lukium/ats-kms/tree/verifier).

The verifier runs approximately **4 times per day** at random times to check that the deployed KMS enclave matches the published manifest and security specifications.

### What Gets Verified:
1. **Manifest Integrity** - Validates manifest structure and accessibility
2. **Hash Verification** - Confirms SHA256 and SRI hashes match for all artifacts
3. **Security Headers** - Verifies CSP, CORP, and other security policies
4. **Allowed List** - Ensures deployed version is in the allowed versions list
5. **Reproducible Build** - Confirms the build can be reproduced from source
6. **GitHub Attestation** - Validates Sigstore attestation via Rekor transparency log

### Trust Model:
- **Verifier Code:** Frozen and auditable at specific commit
- **This Report:** Auto-generated, constantly updated
- **Transparency:** All verification results and attestation URLs are publicly accessible

---

## Verification Details

### ‚úÖ Manifest Fetch

Manifest fetched (v2.0.0)

### ‚úÖ Hash Verification

All hashes verified

| Artifact | Status | Expected | Actual |
|----------|--------|----------|--------|
| **Worker SHA256** | ‚úÖ | `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548` | `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548` |
| **Worker SRI** | ‚úÖ | `sha384-xqXzVuZiljz2HpTEs4lkNyGCTZ0sCfELjLymarEYHAxOLxoO8HSIAmTwe8DHypxm` | `sha384-xqXzVuZiljz2HpTEs4lkNyGCTZ0sCfELjLymarEYHAxOLxoO8HSIAmTwe8DHypxm` |
| **Client.js SRI** | ‚úÖ | `sha384-qu4sQ0KraOAlFctYQ+8P1TPYDxZeJIRF9lk3bFm/ZEKSxqq5nPnfw9QdEosjCG9T` | `sha384-qu4sQ0KraOAlFctYQ+8P1TPYDxZeJIRF9lk3bFm/ZEKSxqq5nPnfw9QdEosjCG9T` |
| **Enclave.css SRI** | ‚úÖ | `sha384-0m6H57PFrArZ+cnrslj5TL4eTidgfi8RMA9WwzXfg/mMJ1AEenTpxckR7C6y/DxQ` | `sha384-0m6H57PFrArZ+cnrslj5TL4eTidgfi8RMA9WwzXfg/mMJ1AEenTpxckR7C6y/DxQ` |


### ‚úÖ GitHub Attestation

Attestation verified via GitHub CLI

**Artifact:** `kms-worker.dcdb17b1.js`

**Commit:** `32de9c743fe83f8ab1fb6e19b89e9e3f23157ef7`

**Rekor Transparency Log:**
https://search.sigstore.dev?logIndex=675358515

**Repository Attestations:**
https://github.com/Lukium/ats-kms-enclave/attestations/12983177

### ‚úÖ Allowed List

Current version is in allowed list

**Current Hash:** `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548`

**Allowed Hashes:**
- `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548`

### ‚úÖ Security Headers

All headers verified

#### content-security-policy ‚úÖ

**Expected:** `default-src 'none'; script-src 'self'; style-src 'self'; img-src 'self' https://raw.githubusercontent.com/Lukium/ats-kms-enclave/attestation/verification-badge.svg; connect-src 'self'; worker-src 'self'; object-src 'none'; base-uri 'none'; frame-ancestors https://alpha.allthe.services https://beta.allthe.services https://allthe.services https://phase2-demo.allthe.services http://localhost:5173; form-action 'none'`

**Actual:** ‚úÖ Matches

**Frame Ancestors Explanation:**
The `frame-ancestors` directive controls which origins can embed the KMS enclave in an iframe:

- `https://alpha.allthe.services` - Development build of the AllTheServices app
- `https://beta.allthe.services` - Beta build (not yet available)
- `https://allthe.services` - Production build (not yet available)
- `https://phase2-demo.allthe.services` - Demo for the KMS enclave itself
- `http://localhost:5173` - Local development counterpart of the dev build

#### permissions-policy ‚úÖ

**Expected:** `accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), bluetooth=(), camera=(), display-capture=(), document-domain=(), encrypted-media=(), fullscreen=(), geolocation=(), gyroscope=(), hid=(), idle-detection=(), magnetometer=(), microphone=(), midi=(), payment=(), picture-in-picture=(), screen-wake-lock=(), serial=(), speaker-selection=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()`

**Actual:** ‚úÖ Matches

#### x-content-type-options ‚úÖ

**Expected:** `nosniff`

**Actual:** ‚úÖ Matches

#### referrer-policy ‚úÖ

**Expected:** `no-referrer`

**Actual:** ‚úÖ Matches

#### cross-origin-opener-policy ‚úÖ

**Expected:** `(not present)`

**Actual:** ‚úÖ Matches

#### cross-origin-embedder-policy ‚úÖ

**Expected:** `(not present)`

**Actual:** ‚úÖ Matches

### ‚úÖ Reproducible Build

Build is reproducible - hash matches

**Commit:** `32de9c743fe83f8ab1fb6e19b89e9e3f23157ef7`

**Expected Hash:** `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548`

**Actual Hash:** `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548`

**Reproduce This Build:**
```bash
git fetch origin 32de9c743fe83f8ab1fb6e19b89e9e3f23157ef7
git checkout 32de9c743fe83f8ab1fb6e19b89e9e3f23157ef7
pnpm install --frozen-lockfile
SOURCE_DATE_EPOCH=1762417782 pnpm build:reproducible
sha256sum dist/enclave/kms-worker.dcdb17b1.js
```

The hash from the last command should match: `dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548`


---

### Manifest Details

```json
{
  "schema": 1,
  "current": {
    "version": "2.0.0",
    "commit": "32de9c743fe83f8ab1fb6e19b89e9e3f23157ef7",
    "artifact": "kms-worker.dcdb17b1.js",
    "sha256": "dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548",
    "files": {
      "worker": {
        "filename": "kms-worker.dcdb17b1.js",
        "sha256": "dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548",
        "sri": "sha384-xqXzVuZiljz2HpTEs4lkNyGCTZ0sCfELjLymarEYHAxOLxoO8HSIAmTwe8DHypxm"
      },
      "client": {
        "filename": "enclave-client.js",
        "sri": "sha384-qu4sQ0KraOAlFctYQ+8P1TPYDxZeJIRF9lk3bFm/ZEKSxqq5nPnfw9QdEosjCG9T"
      },
      "css": {
        "filename": "enclave.css",
        "sri": "sha384-0m6H57PFrArZ+cnrslj5TL4eTidgfi8RMA9WwzXfg/mMJ1AEenTpxckR7C6y/DxQ"
      }
    },
    "timestamp": "2025-11-06T08:31:09.802Z",
    "build": {
      "reproducible": true,
      "environment": "production",
      "SOURCE_DATE_EPOCH": "1762417782"
    },
    "attestation": {
      "rekorUrl": "https://search.sigstore.dev?logIndex=675358515",
      "attestationUrl": "https://github.com/Lukium/ats-kms-enclave/attestations/12983177"
    }
  },
  "allowed": [
    "dcdb17b1b1003e36a5fdb3759e905f502dd93038b31643e12358cb452b2d1548"
  ],
  "deprecated": [],
  "comment": "Phase 2.1: Deterministic builds with SRI (Subresource Integrity)"
}
```

---

*Last updated: Fri, 14 Nov 2025 03:29:40 GMT*
*Verifier: [github.com/lukium/ats-kms/tree/verifier](https://github.com/lukium/ats-kms/tree/verifier)*

